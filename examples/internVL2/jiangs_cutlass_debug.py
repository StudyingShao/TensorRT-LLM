

def format_error_message(error_message):
    # 定义缩进和换行的参数
    indent_level = 0
    indent_space = '    '  # 四个空格作为缩进
    formatted_message = []

    # 分割原始错误信息为多个部分
    for line in error_message.splitlines():
        # 对每一行进行处理
        parts = []
        current_part = ''
        add_indent_space = False

        for char in line:
            current_part += char
            
            # 检测到尖括号或括号时进行换行和缩进
            if char in '<(,':
                if add_indent_space:
                    parts.append(indent_space * (indent_level + 1) + current_part.strip())
                else:
                    parts.append(indent_space * indent_level + current_part.strip())
                add_indent_space = False
                current_part = ''
                if char in '<(':
                    indent_level += 1
            elif char in '>':
                indent_level -= 1
                add_indent_space = True
        
        # 添加最后一部分（如果有剩余）
        if current_part.strip():
            parts.append(current_part.strip())

        # 根据分割的部分构建格式化后的信息
        for part in parts:
            formatted_message.append(part)

    return '\n'.join(formatted_message)


error_info = "cutlass::gemm::kernel::GemmFpAIntB<Mma_, Epilogue_, ThreadblockSwizzle_, KernelArch, SplitKSerial>::Arguments::Arguments(const cutlass::gemm::kernel::GemmFpAIntB<cutlass::gemm::threadblock::DqMmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, cutlass::Array<cutlass::float_e4m3_t, 16, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<256, 64>, cutlass::uint4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<256, 64>, 128, cutlass::PitchLinearShape<8, 4>, 32>, cutlass::Array<cutlass::uint4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, float, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaTensorOpComputeBWithF16<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, float, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::float_e4m3_t, cutlass::layout::RowMajor, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor, float, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1>>, cutlass::gemm::GemmShape<16, 8, 32>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 3, cutlass::FastInterleavedAndBiasedNumericArrayConverter<cutlass::half_t, cutlass::uint4b_t, 32>, cutlass::WeightOnlyQuantOp::FINEGRAINED_SCALE_ONLY, cutlass::gemm::SharedMemoryClearOption::kNone, void>, cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaTensorOpComputeBWithF16<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, float, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::float_e4m3_t, cutlass::layout::RowMajor, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor, float, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1>>, cutlass::gemm::GemmShape<16, 8, 32>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::bfloat16_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, float, cutlass::Array<float, 4, true>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, float, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, float, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::bfloat16_t, 8, float, float, cutlass::epilogue::thread::ScaleType::NoBetaScaling, cutlass::FloatRoundStyle::round_to_nearest, cutlass::bfloat16_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, cutlass::arch::Sm89, true>::Arguments &)" 
error_info1 = "cutlass::gemm::threadblock::DqMmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, cutlass::Array<cutlass::float_e4m3_t, 16, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<256, 64>, cutlass::uint4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<256, 64>, 128, cutlass::PitchLinearShape<8, 4>, 32>, cutlass::Array<cutlass::uint4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, float, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaTensorOpComputeBWithF16<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, float, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::float_e4m3_t, cutlass::layout::RowMajor, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor, float, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1>>, cutlass::gemm::GemmShape<16, 8, 32>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 3, cutlass::FastInterleavedAndBiasedNumericArrayConverter<cutlass::half_t, cutlass::uint4b_t, 32>, cutlass::WeightOnlyQuantOp::FINEGRAINED_SCALE_ONLY, cutlass::gemm::SharedMemoryClearOption::kNone, void>" 


# Mma_=cutlass::gemm::threadblock::DqMmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, cutlass::Array<cutlass::float_e4m3_t, 16, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<8, 4>, 16>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<256, 64>, cutlass::uint4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<256, 64>, 128, cutlass::PitchLinearShape<8, 4>, 32>, cutlass::Array<cutlass::uint4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, cutlass::transform::threadblock::FineGrainedScaleZeroIterator<cutlass::MatrixShape<1, 128>, cutlass::half_t, cutlass::layout::RowMajor, 0, 8>, float, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaTensorOpComputeBWithF16<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, float, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::float_e4m3_t, cutlass::layout::RowMajor, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor, float, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1>>, cutlass::gemm::GemmShape<16, 8, 32>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 3, cutlass::FastInterleavedAndBiasedNumericArrayConverter<cutlass::half_t, cutlass::uint4b_t, 32>, cutlass::WeightOnlyQuantOp::FINEGRAINED_SCALE_ONLY, cutlass::gemm::SharedMemoryClearOption::kNone, void>, 
# Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaTensorOpComputeBWithF16<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::float_e4m3_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<8, 128>, cutlass::uint4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, float, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::float_e4m3_t, cutlass::layout::RowMajor, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor, float, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1>>, cutlass::gemm::GemmShape<16, 8, 32>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::bfloat16_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, float, cutlass::Array<float, 4, true>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, float, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, float, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::bfloat16_t, 8, float, float, cutlass::epilogue::thread::ScaleType::NoBetaScaling, cutlass::FloatRoundStyle::round_to_nearest, cutlass::bfloat16_t>, cutlass::MatrixShape<0, 8>, 1, 1>, 
# ThreadblockSwizzle_=cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 
# KernelArch=cutlass::arch::Sm89, 
# SplitKSerial=true

# 调用格式化函数并输出结果
formatted_output = format_error_message(error_info)
formatted_output1 = format_error_message(error_info1)
print(formatted_output)
print("------------------------------------------------------------------------------------------------------------------------------------")
print(formatted_output1)